{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/professional-portfolio/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\r\n\r\nconst globalForPrisma = globalThis as unknown as { prisma: PrismaClient | undefined }\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: [\"error\", \"warn\"],\r\n  })\r\n\r\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma\r\n"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6HAAA,CAAA,eAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAO;AACxB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/professional-portfolio/lib/validation.ts"],"sourcesContent":["// Lightweight input validation helpers to reduce risk of injection and invalid data\r\n\r\nexport const UUID_REGEX = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i\r\n\r\nexport function isUUID(v: unknown): v is string {\r\n  return typeof v === \"string\" && UUID_REGEX.test(v)\r\n}\r\n\r\nexport function sanitizeString(v: unknown, maxLen = 256): string {\r\n  if (typeof v !== \"string\") return \"\"\r\n  const s = v.trim()\r\n  return s.length > maxLen ? s.slice(0, maxLen) : s\r\n}\r\n\r\nexport function isEmail(v: unknown): v is string {\r\n  if (typeof v !== \"string\") return false\r\n  const s = v.trim()\r\n  if (s.length === 0 || s.length > 254) return false\r\n  // RFC 5322 simplified\r\n  return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(s)\r\n}\r\n\r\nexport function isSafeCategory(v: unknown, maxLen = 64): v is string {\r\n  if (typeof v !== \"string\") return false\r\n  const s = v.trim()\r\n  if (s.length === 0 || s.length > maxLen) return false\r\n  // allow letters, numbers, spaces, dashes, underscores, slashes\r\n  return /^[A-Za-z0-9 _\\-/]+$/.test(s)\r\n}\r\n\r\nexport function clampNumber(n: unknown, min: number, max: number, fallback: number): number {\r\n  const num = typeof n === \"number\" ? n : Number(n)\r\n  if (Number.isNaN(num)) return fallback\r\n  return Math.min(max, Math.max(min, num))\r\n}\r\n"],"names":[],"mappings":"AAAA,oFAAoF;;;;;;;;;AAE7E,MAAM,aAAa;AAEnB,SAAS,OAAO,CAAU;IAC/B,OAAO,OAAO,MAAM,YAAY,WAAW,IAAI,CAAC;AAClD;AAEO,SAAS,eAAe,CAAU,EAAE,SAAS,GAAG;IACrD,IAAI,OAAO,MAAM,UAAU,OAAO;IAClC,MAAM,IAAI,EAAE,IAAI;IAChB,OAAO,EAAE,MAAM,GAAG,SAAS,EAAE,KAAK,CAAC,GAAG,UAAU;AAClD;AAEO,SAAS,QAAQ,CAAU;IAChC,IAAI,OAAO,MAAM,UAAU,OAAO;IAClC,MAAM,IAAI,EAAE,IAAI;IAChB,IAAI,EAAE,MAAM,KAAK,KAAK,EAAE,MAAM,GAAG,KAAK,OAAO;IAC7C,sBAAsB;IACtB,OAAO,6BAA6B,IAAI,CAAC;AAC3C;AAEO,SAAS,eAAe,CAAU,EAAE,SAAS,EAAE;IACpD,IAAI,OAAO,MAAM,UAAU,OAAO;IAClC,MAAM,IAAI,EAAE,IAAI;IAChB,IAAI,EAAE,MAAM,KAAK,KAAK,EAAE,MAAM,GAAG,QAAQ,OAAO;IAChD,+DAA+D;IAC/D,OAAO,sBAAsB,IAAI,CAAC;AACpC;AAEO,SAAS,YAAY,CAAU,EAAE,GAAW,EAAE,GAAW,EAAE,QAAgB;IAChF,MAAM,MAAM,OAAO,MAAM,WAAW,IAAI,OAAO;IAC/C,IAAI,OAAO,KAAK,CAAC,MAAM,OAAO;IAC9B,OAAO,KAAK,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,KAAK;AACrC","debugId":null}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file:///C:/professional-portfolio/lib/admin-auth.ts"],"sourcesContent":["import { cookies } from \"next/headers\"\r\n\r\nfunction safeEqual(a: string, b: string) {\r\n  if (a.length !== b.length) return false\r\n  let out = 0\r\n  for (let i = 0; i < a.length; i++) out |= a.charCodeAt(i) ^ b.charCodeAt(i)\r\n  return out === 0\r\n}\r\n\r\nexport async function isAdminRequestAuthorized(): Promise<boolean> {\r\n  try {\r\n    const jar = await cookies()\r\n    const cookie = jar.get(\"admin_session\")?.value || \"\"\r\n    const expectedUser = (process.env.ADMIN_USER || \"\").trim()\r\n    const expectedPass = (process.env.ADMIN_PASSWORD || \"\").trim()\r\n    const secret = (process.env.ADMIN_SECRET || \"default-secret\").trim()\r\n\r\n    const data = new TextEncoder().encode(`${expectedUser}:${expectedPass}:${secret}`)\r\n    const digest = await crypto.subtle.digest(\"SHA-256\", data)\r\n    const token = Array.from(new Uint8Array(digest)).map((b) => b.toString(16).padStart(2, \"0\")).join(\"\")\r\n\r\n    return safeEqual(cookie, token)\r\n  } catch {\r\n    return false\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAEA,SAAS,UAAU,CAAS,EAAE,CAAS;IACrC,IAAI,EAAE,MAAM,KAAK,EAAE,MAAM,EAAE,OAAO;IAClC,IAAI,MAAM;IACV,IAAK,IAAI,IAAI,GAAG,IAAI,EAAE,MAAM,EAAE,IAAK,OAAO,EAAE,UAAU,CAAC,KAAK,EAAE,UAAU,CAAC;IACzE,OAAO,QAAQ;AACjB;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,MAAM,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;QACxB,MAAM,SAAS,IAAI,GAAG,CAAC,kBAAkB,SAAS;QAClD,MAAM,eAAe,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI,EAAE,EAAE,IAAI;QACxD,MAAM,eAAe,CAAC,QAAQ,GAAG,CAAC,cAAc,IAAI,EAAE,EAAE,IAAI;QAC5D,MAAM,SAAS,CAAC,QAAQ,GAAG,CAAC,YAAY,IAAI,gBAAgB,EAAE,IAAI;QAElE,MAAM,OAAO,IAAI,cAAc,MAAM,CAAC,GAAG,aAAa,CAAC,EAAE,aAAa,CAAC,EAAE,QAAQ;QACjF,MAAM,SAAS,MAAM,OAAO,MAAM,CAAC,MAAM,CAAC,WAAW;QACrD,MAAM,QAAQ,MAAM,IAAI,CAAC,IAAI,WAAW,SAAS,GAAG,CAAC,CAAC,IAAM,EAAE,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,MAAM,IAAI,CAAC;QAElG,OAAO,UAAU,QAAQ;IAC3B,EAAE,OAAM;QACN,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///C:/professional-portfolio/app/api/feedback/moderation/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\r\nimport { prisma } from \"@/lib/prisma\"\r\nimport { isUUID } from \"@/lib/validation\"\r\nimport { isAdminRequestAuthorized } from \"@/lib/admin-auth\"\r\n\r\n// Auth is enforced by middleware; we also validate cookie here for defense-in-depth\r\n\r\nexport async function GET() {\r\n  if (!(await isAdminRequestAuthorized())) return new NextResponse(\"Unauthorized\", { status: 401 })\r\n  try {\r\n    const feedback = await prisma.feedback.findMany({ orderBy: { createdAt: \"desc\" } })\r\n    return NextResponse.json(feedback)\r\n  } catch (e) {\r\n    console.error(\"Database error in moderation GET:\", e)\r\n    return NextResponse.json([])\r\n  }\r\n}\r\n\r\nexport async function PATCH(req: Request) {\r\n  if (!(await isAdminRequestAuthorized())) return new NextResponse(\"Unauthorized\", { status: 401 })\r\n  try {\r\n    const body = await req.json()\r\n    const id = body?.id\r\n    if (!isUUID(id)) return NextResponse.json({ success: false, error: \"Invalid id\" }, { status: 400 })\r\n    await prisma.feedback.update({ where: { id }, data: { approved: true } })\r\n    return NextResponse.json({ success: true })\r\n  } catch (e) {\r\n    console.error(\"Database error in moderation PATCH:\", e)\r\n    return NextResponse.json({ success: false, error: \"Database unavailable\" }, { status: 500 })\r\n  }\r\n}\r\n\r\nexport async function DELETE(req: Request) {\r\n  if (!(await isAdminRequestAuthorized())) return new NextResponse(\"Unauthorized\", { status: 401 })\r\n  try {\r\n    const { searchParams } = new URL(req.url)\r\n    const id = searchParams.get(\"id\") as string\r\n    if (!isUUID(id)) return NextResponse.json({ success: false, error: \"Invalid id\" }, { status: 400 })\r\n    await (prisma as any).feedback.update({ where: { id }, data: { deleted: true, approved: false } })\r\n    return NextResponse.json({ success: true })\r\n  } catch (e) {\r\n    console.error(\"Database error in moderation DELETE:\", e)\r\n    return NextResponse.json({ success: false, error: \"Database unavailable\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;AAIO,eAAe;IACpB,IAAI,CAAE,MAAM,CAAA,GAAA,sHAAA,CAAA,2BAAwB,AAAD,KAAM,OAAO,IAAI,gIAAA,CAAA,eAAY,CAAC,gBAAgB;QAAE,QAAQ;IAAI;IAC/F,IAAI;QACF,MAAM,WAAW,MAAM,+GAAA,CAAA,SAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;YAAE,SAAS;gBAAE,WAAW;YAAO;QAAE;QACjF,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC,qCAAqC;QACnD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,EAAE;IAC7B;AACF;AAEO,eAAe,MAAM,GAAY;IACtC,IAAI,CAAE,MAAM,CAAA,GAAA,sHAAA,CAAA,2BAAwB,AAAD,KAAM,OAAO,IAAI,gIAAA,CAAA,eAAY,CAAC,gBAAgB;QAAE,QAAQ;IAAI;IAC/F,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,KAAK,MAAM;QACjB,IAAI,CAAC,CAAA,GAAA,mHAAA,CAAA,SAAM,AAAD,EAAE,KAAK,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAAa,GAAG;YAAE,QAAQ;QAAI;QACjG,MAAM,+GAAA,CAAA,SAAM,CAAC,QAAQ,CAAC,MAAM,CAAC;YAAE,OAAO;gBAAE;YAAG;YAAG,MAAM;gBAAE,UAAU;YAAK;QAAE;QACvE,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC,uCAAuC;QACrD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5F;AACF;AAEO,eAAe,OAAO,GAAY;IACvC,IAAI,CAAE,MAAM,CAAA,GAAA,sHAAA,CAAA,2BAAwB,AAAD,KAAM,OAAO,IAAI,gIAAA,CAAA,eAAY,CAAC,gBAAgB;QAAE,QAAQ;IAAI;IAC/F,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;QACxC,MAAM,KAAK,aAAa,GAAG,CAAC;QAC5B,IAAI,CAAC,CAAA,GAAA,mHAAA,CAAA,SAAM,AAAD,EAAE,KAAK,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAAa,GAAG;YAAE,QAAQ;QAAI;QACjG,MAAM,AAAC,+GAAA,CAAA,SAAM,CAAS,QAAQ,CAAC,MAAM,CAAC;YAAE,OAAO;gBAAE;YAAG;YAAG,MAAM;gBAAE,SAAS;gBAAM,UAAU;YAAM;QAAE;QAChG,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC,wCAAwC;QACtD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5F;AACF","debugId":null}}]
}